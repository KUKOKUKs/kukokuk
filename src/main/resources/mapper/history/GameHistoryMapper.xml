<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kukokuk.domain.history.mapper.GameHistoryMapper">

    <!-- 스피드 퀴즈 최근 이력 조회 -->
    <select id="getRecentSpeedHistory" resultType="com.kukokuk.domain.history.dto.GameHistoryDto">
        SELECT
            SESSION_NO as sessionNo,
            USER_NO as userNo,
            'speed' as gameType,
            CORRECT_ANSWERS as score,
            TOTAL_TIME_SEC as playTime,
            CREATED_DATE as createdDate,
            NULL as difficulty,
            NULL as questionType
        FROM KUKOKUK_QUIZ_SESSION_SUMMARIES
        WHERE USER_NO = #{userNo}
          AND QUIZ_MODE = 'speed'
        ORDER BY CREATED_DATE DESC
        LIMIT #{limit}
    </select>

    <!-- 단계별 퀴즈 최근 이력 조회 -->
    <select id="getRecentLevelHistory" resultType="com.kukokuk.domain.history.dto.GameHistoryDto">
        SELECT
            SESSION_NO as sessionNo,
            USER_NO as userNo,
            'level' as gameType,
            CORRECT_ANSWERS as score,
            TOTAL_TIME_SEC as playTime,
            CREATED_DATE as createdDate,
            DIFFICULTY as difficulty,
            QUESTION_TYPE as questionType
        FROM KUKOKUK_QUIZ_SESSION_SUMMARIES
        WHERE USER_NO = #{userNo}
          AND QUIZ_MODE = 'level'
        ORDER BY CREATED_DATE DESC
        LIMIT #{limit}
    </select>


</mapper>
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>KUKOKUK ê·¸ë£¹ í•™ìŠµìë£Œ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #f9fafc;
            color: #333;
        }
        h2 { color: #2c3e50; }
        section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        }
        input, button, select {
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-size: 14px;
        }
        button {
            background: #4a6cf7;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover { background: #3e5bdd; }
        pre {
            background: #f4f6f8;
            border-radius: 6px;
            padding: 10px;
            overflow-x: auto;
        }
        .job-row {
            border-bottom: 1px solid #eee;
            padding: 6px 0;
        }
    </style>
</head>
<body>

<h2>ğŸ“š ê·¸ë£¹ í•™ìŠµìë£Œ ì—…ë¡œë“œ & í…ŒìŠ¤íŠ¸ ì½˜ì†”</h2>

<!-- ================= ì—…ë¡œë“œ ì˜ì—­ ================= -->
<section>
    <h3>1ï¸âƒ£ í•™ìŠµìë£Œ ì—…ë¡œë“œ</h3>
    <label>ê·¸ë£¹ ë²ˆí˜¸: <input type="number" id="groupNo" value="1"></label><br><br>
    <label>ë‚œì´ë„:
        <select id="difficulty">
            <option value="1">1 (ê¸°ì´ˆ)</option>
            <option value="2">2</option>
            <option value="3" selected>3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6 (ì‹¬í™”)</option>
        </select>
    </label><br><br>
    <input type="file" id="files" multiple>
    <button onclick="uploadMaterials()">ì—…ë¡œë“œ</button>

    <h4>ê²°ê³¼</h4>
    <pre id="uploadResult">-</pre>
</section>

<!-- ================= Job ìƒíƒœ ì¡°íšŒ ================= -->
<section>
    <h3>2ï¸âƒ£ ì—…ë¡œë“œ Job ìƒíƒœ ì¡°íšŒ</h3>
    <button onclick="fetchJobs()">ê·¸ë£¹ ì „ì²´ Job ìƒíƒœ ì¡°íšŒ</button>
    <div id="jobList"></div>
</section>

<!-- ================= ì¼ì¼í•™ìŠµìë£Œ ëª©ë¡ ================= -->
<section>
    <h3>3ï¸âƒ£ ê·¸ë£¹ ì¼ì¼í•™ìŠµìë£Œ ëª©ë¡</h3>
    <button onclick="fetchDailyStudies()">ì¼ì¼í•™ìŠµìë£Œ ëª©ë¡ ì¡°íšŒ</button>
    <div id="studyList"></div>
</section>

<script>
    async function uploadMaterials() {
        const groupNo = document.getElementById('groupNo').value;
        const difficulty = document.getElementById('difficulty').value;
        const files = document.getElementById('files').files;
        const resultArea = document.getElementById('uploadResult');

        if (files.length === 0) {
            alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
            return;
        }

        const formData = new FormData();
        for (const f of files) formData.append("files", f);
        formData.append("difficulty", difficulty);

        resultArea.textContent = "â³ ì—…ë¡œë“œ ì¤‘...";
        try {
            const res = await fetch(`/api/teachers/groups/${groupNo}/materials/upload`, {
                method: "POST",
                body: formData
            });
            const data = await res.json();
            resultArea.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
            resultArea.textContent = "âŒ ì—…ë¡œë“œ ì‹¤íŒ¨: " + err;
        }
    }
    // ê·¸ë£¹ ì „ì²´ ì§„í–‰ ì¤‘ Job ëª©ë¡ ì¡°íšŒ
    async function fetchJobs() {
        const groupNo = document.getElementById('groupNo').value;
        const jobList = document.getElementById('jobList');
        jobList.innerHTML = "â³ ì¡°íšŒ ì¤‘...";

        try {
            const res = await fetch(`/api/teachers/groups/${groupNo}/materials/jobs`);
            const json = await res.json();

            // ê·¸ëƒ¥ ê²°ê³¼ ì „ì²´ë¥¼ ë³´ê¸° ì¢‹ê²Œ ì¶œë ¥
            jobList.innerHTML = `<pre>${JSON.stringify(json, null, 2)}</pre>`;

        } catch (err) {
            jobList.textContent = "âŒ ì¡°íšŒ ì‹¤íŒ¨: " + err;
        }
    }


    // ê·¸ë£¹ì˜ ì¼ì¼í•™ìŠµìë£Œ ëª©ë¡ ì¡°íšŒ
    async function fetchDailyStudies() {
        const groupNo = document.getElementById('groupNo').value;
        const studyList = document.getElementById('studyList');
        studyList.innerHTML = "â³ ì¡°íšŒ ì¤‘...";

        try {
            const res = await fetch(`/api/teachers/groups/${groupNo}/studies`);
            const json = await res.json();
            // ê·¸ëƒ¥ ì „ì²´ JSONì„ ë³´ê¸° ì¢‹ê²Œ ì¶œë ¥
            studyList.innerHTML = `<pre>${JSON.stringify(json, null, 2)}</pre>`;

        } catch (err) {
            studyList.textContent = "âŒ ì¡°íšŒ ì‹¤íŒ¨: " + err;
        }
    }
</script>
</body>
</html>

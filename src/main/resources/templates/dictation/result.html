<!DOCTYPE html>
<html layout:decorate="~{/layout/center}" th:with="title='받아쓰기 결과'">
<div layout:fragment="content">
    <div id="main-content" class="content_container">
        <div class="content_info">
            <div class="content_title justify_content_center">
                <iconify-icon icon="flat-color-icons:voice-presentation"></iconify-icon>
                받아쓰기 결과
            </div>

            <div class="grid_list_component" style="--cols: 2;">
                <div class="component grid_list full_grid bg_primary color_white highlight">
                    <div class="component_title">
                        <th:block th:with="
                                percent=${(summary.correctAnswers * 100) / summary.totalQuestion },
                                resultMsg=${
                                    percent == 100 ? '완벽, 받아쓰기의 끝판왕 👑' :
                                    percent >= 90 ? '감 잡았어! 집중력 최고 🔥' :
                                    percent >= 70 ? '흐름 탔어! 바로 다시 가보자 🚀' :
                                    percent >= 50 ? '이제부터 시작이지! ⚡' :
                                    '배운 건 더 많아! 한번 더! 💡'
                                }">
                            <p class="title_info center" th:utext="${resultMsg}"></p>
                        </th:block>
                    </div>
                </div>
                <div class="component grid_list">
                    <div class="component_title">
                        <p class="component_sub_title tac" th:text="|${summary.totalQuestion}문제 중|">n문제 중</p>
                        <p class="title_info center">
                            [[${summary.correctAnswers}]]개 정답!
                            <span th:if="${summary.totalQuestion == summary.correctAnswers}">💯</span>
                        </p>
                    </div>
                </div>
                <div class="component grid_list">
                    <div class="component_title">
                        <p class="component_sub_title tac" th:text="|총 풀이 시간 ${summary.totalTimeSec}초|">총 풀이 시간 N.nnn초</p>
                        <p class="title_info center" th:text="|문제당 평균 ${summary.averageTimePerQuestion}초|">문제당 평균 N.nnn초</p>
                    </div>
                </div>
            </div>
        </div>

        <!--/* 문제 풀이 상세 결과 */-->
        <div class="component tiny_list_component h_100 show_scroll">
            <div class="component_info with_icon align_start sub_font"
                 th:each="result, iterStat : ${results}">
                <div class="list_info ov_v" style="--cols: 18; --indexCols: 2;">
                    <div class="index_list">
                        <span class="color_primary bold" th:text="|Q${iterStat.count}|">Q1</span>
                        <p th:text="${result.question}">문제</p>
                    </div>
                    <div class="index_list">
                        <div class="color_blue bold pos_r">
                            A
                            <span class="result_icon icon large"
                                  th:classappend="${result.success ? 'correct' : 'incorrect'}"></span>
                        </div>
                        <p th:text="${result.userAnswer ?: '입력하지 않음'}">입력한 내용</p>
                    </div>
                </div>

                <!--/* 다시 듣기 버튼 */-->
                <button type="button"
                        class="repeat_btn tooltip"
                        th:data-question-no="${result.dictationQuestionNo}"
                        th:data-question="${result.question}"
                        data-label="다시 듣기">
                    <iconify-icon class="icon title_font color_primary" icon="fluent:speaker-2-16-regular"></iconify-icon>
                </button>
            </div>
        </div>

        <div class="btn_list">
            <a href="/quiz" class="btn">국어 놀이터로</a>
            <a href="/" class="btn white">마당으로</a>
            <a href="/dictation/start" class="btn primary">다시 도전!</a>
        </div>

        <div id="sessions-check" style="padding:12px;border:1px dashed #bbb;border-radius:8px;margin:12px 0;font-size:14px;line-height:1.6;">
            <div><strong>세트번호</strong> : <span id="v-dictationSessionNo">-</span></div>
            <div><strong>점수</strong> : <span id="v-correctScore">-</span></div>
            <div><strong>맞춘 개수</strong> : <span id="v-correctCount">-</span></div>
            <div><strong>힌트 총 사용</strong> : <span id="v-hintUsedCount">-</span></div>
            <div><strong>생성일</strong> : <span id="v-createdDate">-</span></div>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <script type="module" th:src="@{/js/modules/dictation/dictation.js}"></script>
</th:block>
</html>
<!DOCTYPE html>
<html>
<div th:fragment="level-rank-component-fragment(ranksDto)"
     class="component tiny_list_component ranks_component">
    <div class="component_title">
        <div class="title_info align_center">레벨 순위</div>
    </div>

    <div class="tiny_list_component">
        <div th:each="rank : ${ranksDto.ranks}"
             class="component_info tiny column tiny_gap"
             th:with="isMyRank=${rank.userNo == ranksDto.userNo},
                    rawPercent=${(rank.experiencePoints * 100.0) / rank.maxExp},
                    percent=${rawPercent % 1 == 0} ?
                        ${#numbers.formatDecimal(rawPercent, 0, 0)} + '%' :
                        ${#numbers.formatDecimal(rawPercent, 1, 1)} + '%'"
             th:classappend="${isMyRank ? 'selected' : ''}">
            <div class="index_list w_100" style="--cols: 12; --indexCols: 1;">
                <div class="rank"
                     th:classappend="${rank.userRank < 4 ? 'medal' : ''}">
                    <!--/* 순위권 1~3 */-->
                    <th:block th:if="${rank.userRank < 4}">
                        <iconify-icon
                            th:icon="'fluent-emoji-flat:' +
                                             (${rank.userRank == 1} ? '1st' :
                                             (${rank.userRank == 2} ? '2nd' : '3rd')) +
                                             '-place-medal'">
                        </iconify-icon>
                    </th:block>

                    <!--/* 순위권 4~5 */-->
                    <th:block th:if="${rank.userRank > 3 && rank.userRank < 6}">
                        <iconify-icon class="color_gray" th:icon="|ri:number-${rank.userRank}|"></iconify-icon>
                    </th:block>

                    <!--/* 사용자 순위가 순위권 밖인 경우 */-->
                    <th:block th:if="${isMyRank && rank.userRank > 5}">
                        <span class="small_font color_gray" th:text="|${rank.userRank}위|"></span>
                    </th:block>
                </div>
                <div class="d_flex align_center tiny_gap">
                    <div class="rank_profile icon base">
                        <img th:src="${rank.profileFileUrl}" alt="프로필 이미지">
                    </div>
                    <p class="rank_nickname small_font bold text_ellipsis" th:text="${rank.nickname}">닉네임</p>
                    <p class="rank_score bold color_primary" th:text="|Lv.${rank.level}|">Lv.레벨</p>
                </div>
            </div>

            <div class="bar_gauge">
                <div class="gauge" th:style="|width: ${percent};|"></div>
                <span class="gauge_info" th:text="|${rank.experiencePoints} / ${rank.maxExp}|">0 / 1</span>
            </div>
        </div>
    </div>
</div>
</html>
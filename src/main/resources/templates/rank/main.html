<!DOCTYPE html>
<html layout:decorate="~{layout/base}" th:with="title='ÏàúÏúÑ', menu='rank'">

<div layout:fragment="content">
    <div id="main-content" class="content_container">
        <div class="content_info">
            <div class="content_title">
                <div class="d_flex align_center tiny_gap">
                    <iconify-icon icon="streamline-ultimate-color:ranking-stars-ribbon"></iconify-icon>
                    ÏàúÏúÑ
                </div>

                <!--/* Ïõî Ï†ÑÌôò Î≤ÑÌäº(ÏµúÍ∑º 3Îã¨Îßå Ï°∞ÌöåÌï† Ïàò ÏûàÎèÑÎ°ù) */-->
                <div id="rank-history-btn"
                     class="content_switcher stepper_btn">
                    <button type="button" class="step_info left">
                        <iconify-icon icon="ep:arrow-left"></iconify-icon>
                    </button>
                    <p class="step_info center">ÎÇ¥Ïö©</p>
                    <button type="button" class="step_info right">
                        <iconify-icon icon="ep:arrow-right"></iconify-icon>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="content_info">
        <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
        <div class="content_title">
            <iconify-icon icon="fluent-color:trophy-28"></iconify-icon>
            <span th:text="${contentTypeName + ' Îû≠ÌÇπ'}">Ïä§ÌîºÎìúÌÄ¥Ï¶à Îû≠ÌÇπ</span>
            <div class="content_sub_title">
                <span th:text="${rankMonth}">2025-01</span> ÏõîÍ∞Ñ Îû≠ÌÇπ
            </div>
        </div>

        <!-- Ïª®Ìä∏Î°§ ÏòÅÏó≠ -->
        <div class="ranking_controls">
            <!-- Ïª®ÌÖêÏ∏† ÌÉÄÏûÖ ÏÑ†ÌÉù -->
            <div class="component">
                <div class="component_title">
                    <iconify-icon icon="fluent-color:games-24"></iconify-icon>
                    Í≤åÏûÑ Ï¢ÖÎ•ò
                </div>
                <div class="content_type_selector">
                    <a th:href="@{/templates/rank(contentType='SPEED', rankMonth=${rankMonth})}"
                       class="content_type_btn"
                       th:classappend="${contentType == 'SPEED'} ? 'active' : ''">
                        <iconify-icon icon="flat-color-icons:flash-on"></iconify-icon>
                        Ïä§ÌîºÎìúÌÄ¥Ï¶à
                    </a>
                    <a th:href="@{/templates/rank(contentType='LEVEL', rankMonth=${rankMonth})}"
                       class="content_type_btn"
                       th:classappend="${contentType == 'LEVEL'} ? 'active' : ''">
                        <iconify-icon icon="flat-color-icons:graduation-cap"></iconify-icon>
                        Îã®Í≥ÑÎ≥Ñ ÌÄ¥Ï¶à
                    </a>
                    <a th:href="@{/templates/rank(contentType='DICTATION', rankMonth=${rankMonth})}"
                       class="content_type_btn"
                       th:classappend="${contentType == 'DICTATION'} ? 'active' : ''">
                        <iconify-icon icon="flat-color-icons:edit"></iconify-icon>
                        Î∞õÏïÑÏì∞Í∏∞
                    </a>
                </div>
            </div>

            <!-- Ïõî ÏÑ†ÌÉù -->
            <div class="component">
                <div class="component_title">
                    <iconify-icon icon="fluent-color:calendar-24"></iconify-icon>
                    Ï°∞Ìöå Ïõî
                </div>
                <div class="month_selector">
                    <a th:if="${prevMonth != null}"
                       th:href="@{/templates/rank(contentType=${contentType}, rankMonth=${prevMonth})}"
                       class="month_nav_btn">
                        <iconify-icon icon="fluent:arrow-left-24-filled"></iconify-icon>
                        <span th:text="${prevMonth}">2024-12</span>
                    </a>

                    <div class="current_month">
                        <span th:text="${rankMonth}">2025-01</span>
                        <span th:if="${isCurrentMonth}" class="current_badge">ÌòÑÏû¨</span>
                    </div>

                    <a th:if="${nextMonth != null}"
                       th:href="@{/templates/rank(contentType=${contentType}, rankMonth=${nextMonth})}"
                       class="month_nav_btn">
                        <span th:text="${nextMonth}">2025-02</span>
                        <iconify-icon icon="fluent:arrow-right-24-filled"></iconify-icon>
                    </a>
                </div>
            </div>
        </div>

        <!-- ÎÇ¥ Îû≠ÌÇπ Ï†ïÎ≥¥ -->
        <div th:if="${myRankingInfo != null}" class="my_ranking_section">
            <div class="component my_ranking_card">
                <div class="component_title">
                    <iconify-icon icon="fluent-color:person-star-24"></iconify-icon>
                    ÎÇ¥ Îû≠ÌÇπ Ï†ïÎ≥¥
                </div>
                <div class="my_ranking_content">
                    <div class="my_rank_item">
                        <div class="rank_info">
                            <span class="rank_label">ÏàúÏúÑ</span>
                            <span class="rank_value" th:text="${myRanking != null ? myRanking + 'ÏúÑ' : 'ÏàúÏúÑÍ∂å Î∞ñ'}">5ÏúÑ</span>
                        </div>
                        <div class="score_info">
                            <span class="score_label">ÌèâÍ∑† Ï†êÏàò</span>
                            <span class="score_value" th:text="${#numbers.formatDecimal(myRankingInfo.totalScore, 0, 1)} + 'Ï†ê'">85.5Ï†ê</span>
                        </div>
                        <div class="play_info">
                            <span class="play_label">ÌîåÎ†àÏù¥ ÌöüÏàò</span>
                            <span class="play_value" th:text="${myRankingInfo.playCount} + 'Ìöå'">12Ìöå</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Îû≠ÌÇπ Î¶¨Ïä§Ìä∏ -->
        <div class="ranking_section">
            <div class="component">
                <div class="component_title">
                    <iconify-icon icon="fluent-color:trophy-24"></iconify-icon>
                    Ï†ÑÏ≤¥ Îû≠ÌÇπ
                    <div class="ranking_count">
                        Ï¥ù <span th:text="${#lists.size(globalRankings)}">50</span>Î™Ö
                    </div>
                </div>

                <div class="ranking_table_container">
                    <div th:if="${!#lists.isEmpty(globalRankings)}" class="ranking_table">
                        <!-- ÌÖåÏù¥Î∏î Ìó§Îçî -->
                        <div class="ranking_row header">
                            <div class="rank_col">ÏàúÏúÑ</div>
                            <div class="user_col">ÏÇ¨Ïö©Ïûê</div>
                            <div class="score_col">ÌèâÍ∑†Ï†êÏàò</div>
                            <div class="play_col">ÌöüÏàò</div>
                            <div class="group_col">Í∑∏Î£π</div>
                        </div>

                        <!-- Îû≠ÌÇπ Îç∞Ïù¥ÌÑ∞ -->
                        <div th:each="ranking, stat : ${globalRankings}"
                             class="ranking_row data"
                             th:classappend="${stat.index < 3} ? 'top-' + (${stat.index + 1}) : ''"
                             th:data-user-no="${ranking.userNo}">

                            <div class="rank_col">
                                <span th:if="${stat.index == 0}" class="medal gold">ü•á</span>
                                <span th:if="${stat.index == 1}" class="medal silver">ü•à</span>
                                <span th:if="${stat.index == 2}" class="medal bronze">ü•â</span>
                                <span th:if="${stat.index > 2}" class="rank_number" th:text="${stat.index + 1}">4</span>
                            </div>

                            <div class="user_col">
                                <div class="user_profile">
                                    <div class="profile_image">
                                        <img th:if="${ranking.profileFilename != null}"
                                             th:src="@{'/images/profile/' + ${ranking.profileFilename}}"
                                             th:alt="${ranking.nickname}" />
                                        <iconify-icon th:unless="${ranking.profileFilename != null}"
                                                      icon="iconamoon:profile-circle-fill"></iconify-icon>
                                    </div>
                                    <span class="nickname" th:text="${ranking.nickname}">ÎãâÎÑ§ÏûÑ</span>
                                </div>
                            </div>

                            <div class="score_col">
                                <span class="score_value" th:text="${#numbers.formatDecimal(ranking.totalScore, 0, 1)}">85.5</span>
                                <span class="score_unit">Ï†ê</span>
                            </div>

                            <div class="play_col">
                                <span class="play_count" th:text="${ranking.playCount}">15</span>
                                <span class="play_unit">Ìöå</span>
                            </div>

                            <div class="group_col">
                                <span th:if="${ranking.groupTitle != null}"
                                      class="group_name"
                                      th:text="${ranking.groupTitle}">Í∑∏Î£πÎ™Ö</span>
                                <span th:unless="${ranking.groupTitle != null}" class="no_group">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Îû≠ÌÇπ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏùÑ Í≤ΩÏö∞ -->
                    <div th:if="${#lists.isEmpty(globalRankings)}" class="no_ranking_data">
                        <iconify-icon icon="fluent-color:trophy-off-24"></iconify-icon>
                        <p>ÏïÑÏßÅ Îû≠ÌÇπ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                        <p class="sub_text">Í≤åÏûÑÏùÑ ÌîåÎ†àÏù¥ÌïòÍ≥† Ï≤´ Î≤àÏß∏ Îû≠ÌÇπÏóê ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÎÇ¥ ÏõîÎ≥Ñ ÌûàÏä§ÌÜ†Î¶¨ -->
        <div th:if="${!#lists.isEmpty(myHistory)}" class="history_section">
            <div class="component">
                <div class="component_title">
                    <iconify-icon icon="fluent-color:history-24"></iconify-icon>
                    ÎÇ¥ ÏõîÎ≥Ñ Í∏∞Î°ù
                </div>
                <div class="history_chart_container">
                    <div class="history_chart">
                        <div th:each="history : ${myHistory}" class="history_item">
                            <div class="history_month" th:text="${history.rankMonth}">2024-12</div>
                            <div class="history_bar_container">
                                <div class="history_bar"
                                     th:style="'height: ' + ${history.totalScore} + '%'"></div>
                            </div>
                            <div class="history_score" th:text="${#numbers.formatDecimal(history.totalScore, 0, 1)}">85.5</div>
                            <div class="history_plays" th:text="${history.playCount} + 'Ìöå'">12Ìöå</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Îû≠ÌÇπ ÏïàÎÇ¥ -->
        <div class="ranking_info_section">
            <div class="component">
                <div class="component_title">
                    <iconify-icon icon="fluent-color:info-24"></iconify-icon>
                    Îû≠ÌÇπ ÏïàÎÇ¥
                </div>
                <div class="ranking_info_content">
                    <div class="info_grid">
                        <div class="info_item">
                            <iconify-icon icon="fluent-color:calendar-clock-24"></iconify-icon>
                            <div class="info_text">
                                <strong>ÏõîÎ≥Ñ ÏßëÍ≥Ñ</strong>
                                <span>Îß§Ïõî 1Ïùº ÏûêÏ†ïÏóê Îû≠ÌÇπÏù¥ Ï¥àÍ∏∞ÌôîÎê©ÎãàÎã§.</span>
                            </div>
                        </div>
                        <div class="info_item">
                            <iconify-icon icon="fluent-color:calculator-24"></iconify-icon>
                            <div class="info_text">
                                <strong>ÌèâÍ∑† Ï†êÏàò</strong>
                                <span>Ïó¨Îü¨ Î≤à ÌîåÎ†àÏù¥ Ïãú Î™®Îì† Ï†êÏàòÏùò ÌèâÍ∑†ÏúºÎ°ú Í≥ÑÏÇ∞Îê©ÎãàÎã§.</span>
                            </div>
                        </div>
                        <div class="info_item">
                            <iconify-icon icon="fluent-color:trophy-24"></iconify-icon>
                            <div class="info_text">
                                <strong>ÏàúÏúÑ Í≤∞Ï†ï</strong>
                                <span>ÌèâÍ∑† Ï†êÏàò ‚Üí ÌîåÎ†àÏù¥ ÌöüÏàò ‚Üí ÏµúÏã† ÌîåÎ†àÏù¥ ÏàúÏúºÎ°ú Ï†ïÎ†¨Îê©ÎãàÎã§.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<th:block layout:fragment="script">
    <script th:src="@{/js/modules/ranking/ranking-main.js}"></script>
</th:block>
</html>